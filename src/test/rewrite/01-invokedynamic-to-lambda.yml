# SPDX-FileCopyrightText: Copyright (c) 2024-2025 Objectionary.com
# SPDX-License-Identifier: MIT
---
name: invokeinterface-to-lambda
pattern: |
  ⟦
    𝐵1,
    𝜏1 ↦ ⟦
      base ↦ "Q.jeo.opcode.invokedynamic",
      𝜏2 ↦ 186,
      𝜏3 ↦ 𝑒1,
      𝜏4 ↦ 𝑒2,
      𝜏5 ↦ ⟦
        base ↦ "Q.jeo.handle",
        𝜏6 ↦ 6,
        𝜏7 ↦ "java/lang/invoke/LambdaMetafactory",
        𝜏8 ↦ "metafactory",
        𝜏9 ↦ "(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodHandle;Ljava/lang/invoke/MethodType;)Ljava/lang/invoke/CallSite;",
        𝜏10 ↦ Φ̇.false,
        𝐵10
      ⟧,
      𝜏11 ↦ ⟦
        base ↦ "Q.jeo.type",
        𝜏12 ↦ 𝑒3,
        𝐵11
      ⟧,
      𝜏13 ↦ ⟦
        base ↦ "Q.jeo.handle",
        𝜏14 ↦ 6,
        𝜏15 ↦ 𝑒4,
        𝜏16 ↦ 𝑒5,
        𝜏17 ↦ 𝑒6,
        𝜏18 ↦ Φ̇.false,
        𝐵12
      ⟧,
      𝜏19 ↦ ⟦
        base ↦ "Q.jeo.type",
        𝜏21 ↦ 𝑒7,
        𝐵13
      ⟧,
      𝐵14
    ⟧,
    𝜏22 ↦ ⟦
      base ↦ "Q.jeo.opcode.invokeinterface",
      𝜏23 ↦ 185,
      𝜏24 ↦ 𝑒8,
      𝜏25 ↦ 𝑒9,
      𝜏26 ↦ 𝑒10,
      𝜏27 ↦ Φ̇.true,
      𝐵15
    ⟧,
    𝐵2
  ⟧
result: |
  ⟦
    𝐵1,
    𝜏1 ↦ ⟦
      base ↦ "Q.hone.lambda",
      method ↦ 𝑒1,
      interface ↦ 𝑒2,
      signature ↦ 𝑒3,
      target-class ↦ 𝑒4,
      target-method ↦ 𝑒5,
      target-signature ↦ 𝑒6,
      intermediate-signature ↦ 𝑒7,
      stream-class ↦ 𝑒8,
      stream-method ↦ 𝑒9,
      stream-signature ↦ 𝑒10
    ⟧,
    𝐵2
  ⟧
