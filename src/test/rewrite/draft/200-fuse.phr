# SPDX-FileCopyrightText: Copyright (c) 2023-2025 Objectionary.com
# SPDX-License-Identifier: MIT
---
# yamllint disable rule:line-length
name: fuse-map-map
pattern: |
  âŸ¦
    ğµ0,
    ğœ-class â†¦ âŸ¦
      Ï† â†¦ Î¦.jeo.class,
      ğµ-class-head,
      ğœ-method â†¦ âŸ¦
        Ï† â†¦ Î¦.jeo.method,
        ğµ-method-head,
        body â†¦ âŸ¦
          ğµ-body-head,
          ğœ-first â†¦ âŸ¦
            Ï† â†¦ Î¦.hone.reduceX,
            method â†¦ ğ‘’-first-method-name,
            in â†¦ ğ‘’-first-input-type,
            body â†¦ âŸ¦ ğµ-first-body âŸ§
          âŸ§,
          ğœ-second â†¦ âŸ¦
            Ï† â†¦ Î¦.hone.reduceX,
            method â†¦ ğ‘’-second-method-name,
            in â†¦ ğ‘’-second-input-type,
            body â†¦ âŸ¦ ğµ-second-body âŸ§
          âŸ§,
          ğµ-body-tail
        âŸ§,
        ğµ-method-tail
      âŸ§,
      ğµ-class-tail,
      ğµ6
    âŸ§,
    ğµ7
  âŸ§
result: |
  âŸ¦
    ğµ0,
    ğœ-class â†¦ âŸ¦
      Ï† â†¦ Î¦.jeo.class,
      ğµ-class-head,
      ğœ-method â†¦ âŸ¦
        Ï† â†¦ Î¦.jeo.method,
        ğµ-method-head,
        body â†¦ âŸ¦
          ğµ-body-head,
          ğœ-first â†¦ âŸ¦
            Ï† â†¦ Î¦.hone.reduceX,
            method â†¦ ğ‘’-first-method-name,
            in â†¦ ğ‘’-first-input-type,
            body â†¦ âŸ¦
              ğµ-first-body,
              ğµ-second-body
            âŸ§
          âŸ§,
          ğµ-body-tail
        âŸ§,
        ğµ-method-tail
      âŸ§,
      ğµ-class-tail,
      ğµ6
    âŸ§,
    ğµ7
  âŸ§
where:
  - meta: ğœ-fuse
    function: random-tau
    args: ['base', 'ğµ1', 'ğµ6', 'ğœ-method']
  - meta: ğœ-fuse-opcode
    function: random-tau
    args: ['ğµ3', 'ğµ4']
  - meta: ğ‘’-fuse-method-name
    function: concat
    args:
      - ğ‘’-first-method-name
      - '"_fuse"'
  - meta: ğ‘’-fuse-descriptor
    function: concat
    args:
      - '"("'
      - ğ‘’-first-input-type
      - '"Ljava/util/function/Consumer;)V"'
  - meta: ğ‘’-first-descriptor
    function: concat
    args:
      - '"("'
      - ğ‘’-first-input-type
      - '")"'
      - ğ‘’-first-output-type
  - meta: ğ‘’-second-descriptor
    function: concat
    args:
      - '"("'
      - ğ‘’-second-input-type
      - '")"'
      - ğ‘’-second-output-type
